name: CI Release
on:
  release:
    types: [created]
jobs: 
  test_release: 
    name: Check release
    runs-on: ubuntu-18.04
    steps: 
      - uses: actions/checkout@master
      - name: Remove package-lock
        run: rm -rf package-lock.json
      - name: Install dependencies
        run: npm install
      - name: build 
        if: success()
        run: npm run build
      - name: Check version
        if: success()
        run: npm run check:release 
      - name: Prepare package
        if: success()
        run: npm pack
      - name: Get version
        run: "[set-output name=version;]$(npm run package-version)"
        id: build_package
      - name: Upload package to release[binaries]
        uses: actions/upload-artifact@master
        with: 
          name: kintone-kintone-ui-component-0.0.34.tgz
          path: kintone-kintone-ui-component-0.0.34.tgz
  
      


